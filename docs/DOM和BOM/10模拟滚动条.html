<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>10模拟滚动条</title>
	<style type="text/css">
		 * {margin: 0;padding: 0;}
        .box {
            width: 300px;
            height: 500px;
            border: 1px solid red;
            margin: 100px;
            position: relative;

            overflow: hidden;

            /* 不让文字被选中 */
            -webkit-user-select:none;
            -moz-user-select:none;
            -ms-user-select:none;
            user-select:none;
        }
        .content {
            padding: 5px 18px 5px 5px;
            position: absolute;
            top: 0;
            left: 0;

        }
        .scroll {
            width: 18px;
            height: 100%;
            position: absolute;
            top: 0;
            right: 0;
            background-color: #eee;
        }
        .bar {
            height: 100px;
            width: 100%;
            position: absolute;
            top: 0;
            left: 0;
            background-color: red;
            border-radius:  10px;
            cursor: pointer;
        }
	</style>
</head>
<body>
	<div class="box" id="box">
	    <div class="content" id="content">
	       我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	       我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容， 我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容， 我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内 我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内 我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内 我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内 我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内 我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内 我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，
	        我是文字内容，我是文字内容，我是文字内容，完
	    </div>
    	<div class="scroll" id="scroll">
        	<div class="bar" id="bar"></div>
    	</div>
	</div>

	<script type="text/javascript" src='common.js'></script>
	<script type="text/javascript">
		var box = $my('box');
		var content = $my('content');
		var scroll = $my('scroll');
		var bar = $my('bar');

		// 设置滚动条的高度
		var barHeight = 0;
		// 当内容的高度大于盒子的高度才有滚动条
		if (content.scrollHeight > box.offsetHeight) {
			// clientHeight 不包括边框
			barHeight = box.clientHeight / content.scrollHeight * scroll.clientHeight;
		}
		bar.style.height = barHeight + 'px';

		// 鼠标按住滚动条,只是上下滚动而已
		bar.onmousedown = function(e){
			// 获取鼠标在滚动条的位置
			var y = getPage(e).pageY - box.offsetTop - bar.offsetTop;

			// 滚动条随鼠标滚动
			document.onmousemove = function(e){
				var scrollY = getPage(e).pageY - y - box.offsetTop;
				// 注意滚动条可能滚动出去
				scrollY = scrollY < 0 ? 0 : scrollY;  // 不能小于0
				// 这里注意边框，但是问题不大
				scrollY = scrollY > scroll.clientHeight - bar.clientHeight ? scroll.clientHeight - bar.clientHeight : scrollY;
				bar.style.top = scrollY + 'px';


				// 内容也应该滚动
				// 滚动条滚动的最大距离
				var maxScrollBar = scroll.clientHeight - bar.clientHeight;
				// 内容能滑动的最大距离
				var maxScrollContent = content.scrollHeight - box.clientHeight;

				// 内容向上划的距离
				var contentY = scrollY / maxScrollBar * maxScrollContent;
				content.style.top = -contentY + 'px';  // 内容是向上滑动
			}
		}

		// 鼠标弹起来时滚动条不再滚动
		document.onmouseup = function(){  // 注意事件对象
			document.onmousemove = null;
		}
	</script>
</body>
</html>